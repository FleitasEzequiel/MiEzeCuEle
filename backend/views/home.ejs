<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiEzeCuEle</title>
</head>
<body style="padding: 0; margin: 0; display: flex; flex-direction: row;">
    <div style="display: flex;background-color: rgb(108, 102, 102); width: 20%;min-height: 100vh; flex-direction: column;">
        <h1>MiEzeCuEle</h1>
        <form method="post">
            <input type="hidden" name="type" value="logout">
            <button onclick="logout()">Logout</button>
        </form>
        <div style="display: flexbox;">
            <% for (var i = 0; i < info.dbs.length; i++) { %>
                    <ul onclick="
                        (event.currentTarget.getAttribute('open') === 'true') ? 
                        event.currentTarget.setAttribute('open',false) :
                        event.currentTarget.setAttribute('open',true)"
                        open="false"
                        style="cursor:pointer">
                        <%=info.dbs[i].database%>
                        <% for (var j = 0; j < info.dbs[i].tables.length; j++) { %>
                            <li><%=info.dbs[i].tables[j]%></li>                        
                            <% } %>
                        </ul>
              <% } %>
        </div>
    </div>
    <main style="display:inline-flex; width: 100%; flex-direction: column;">
        <div style="display:grid; grid-template-rows: 15% 65% 20%;width: 100%; height:100%;">
            <div style="display:flex; justify-content: center;align-items: center;">
                <form  method="post" >
                    <input type="text" name="query" placeholder="Escribir consulta acÃ¡...">
                    <button >Query</button>
                </form>
            </div>
            <div>
                <% console.log(info.result)%>
                <% if (info.result) {%>
                    <table>
                        <tr style="background-color: antiquewhite;">
                            <% for (var i = 0; i < info.result[1].length; i++) { %>
                                <th><%=info.result[1][i].name%></th>
                              <% } %>
                        </tr>
                        <% for (var i = 0; i < Object.values(info.result[0]).length; i++) { %>
                            <tr>
                           <% for (var j = 0; j < Object.values(info.result[0][i]).length; j++) { %>
                            <td><%=Object.values(info.result[0][i])[j]%></td>
                           <% } %>
                        </tr>
                          <% } %>
                    </table>
                    <%}%>
                    
                    <%=info.error%>

            </div>
        </div>
    </main>
</body>

<style>
    body{
        background-color: rgb(177, 166, 166)
    }
    input{
        color: rgb(110, 102, 102);
        border-radius: 16px;
    }
    ul[open=false]>li{
        height: 0;
        visibility: hidden;
    }
    ul[open=true]>li{
        height: 100%;
        visibility: visible;
        animation-name: dropdown;
        animation-duration: 200ms;
    }
    @keyframes dropdown {
  from {
    transform: translate(0,-10px);
    opacity: 0;
  }
  to {
    transform: translate(0,0);
    opacity: 100%;
  }
}
</style>
<script>
    // Obtain Info
    console.log("intento",infos)

    const logout = () =>{
        window.location.reload()
    }

    const render = () =>{
        renderClose()
    }
    render()
</script>
</html>